name: CI

on: [pull_request]

jobs:
  linux_x64_build:
    runs-on: ubuntu-16.04
    steps:
     - name: checkout
       uses: actions/checkout@master
     - name: build
       run: docker build -t zingolabs/zcashdebian -f .github/jobs/build/debian/Dockerfile.newcommit .
     - name: sanity_check_docker_images
       run: docker images
     - name: save_build_image
       run: docker save -o ${GITHUB_WORKSPACE}/zingolabs_zcashdebian.tar zingolabs/zcashdebian
  linux_x64_btest:
    runs-on: ubuntu-16.04
    needs: linux_x64_build
    steps:
     - name: sanity_check_docker_images
       run: docker images
     - name: look
       run: ls -la ${GITHUB_WORKSPACE}
     - name: load_build_image
       run: docker load ${GITHUB_WORKSPACE}/zingolabs_zcashdebian.tar
     - name: run_image
       run: docker run zingolabs_zcashdebian
